# 关于做自己云音乐的网站的说明
- 刚开始接到这个考核的时候确实有点懵, 但我觉得确实很有挑战性，做自己的音乐网站，我觉得是非常不错的，同时还可以自己设计自己的云音乐网站，真正做成自己喜欢的的一个音乐网站, 我觉得非常有意义!

- 搭建工程: 首先建立一个首页`index.html`, css文件夹包含`index.css, reset.css(重置样式)`两个文件，assets用来包含font imgs两个文件夹，font字体图标文件夹，imgs用来存放图片的文件夹， 因为是使用纯js来实现网站的功能，所以单独建立一个js文件夹。

- js代码规范: 对首页的功能, 关于`index.js`, 一个功能 就单独使用一个立即执行函数封装，返回一个初始化函数，防止太多变量在全局难以维护。

- 我借鉴网易云音乐好的模块，加上自己的想法来做的，会做成自己喜欢的一个自己云音乐网站。

- 由于可能获取dom元素比较多,所以我简单封装了简单的获取dom元素方法的`o$函数`, 使用jQuery只是单纯用来获取歌词而已,因为网易云文档的歌词文档有点问题,请求不回来歌词,用jQuery的ajax的jsonp才可以获取回来

- 关于js实现功能防止污染全局变量我使用的方法，我在每个模块的每个功能封装成立即执行函数，返回一个初始化函数，因此全局变量就变得非常少了，减少了很多的麻烦。

# 关于文件

- 一共有三个`html`文件，分别是`主页页面index.html`,  `播放器页面music.html`, `用户详情页面userDetail.html`, 我大致是按照这样划分的，主页放主要的功能，播放器是音乐播放功能，可以传歌曲id就可以，不传歌曲id的话就默认播放我喜欢的的歌单的自己喜欢的歌， 用户详情页面是在登录之后就可以在头像哪里下的菜单点击进入。

- 一共有四个`js`文件，分别是`主页功能index.js`, `播放器功能music.js`, `用户详情页面功能userDetail.js`, `获取歌词jQuery文件`， 关于jQuery文件的说明，因为在请求拿到歌词时网易云的一个接口使用不了，都是跨域的，但是我试了用jQuery的ajax方法中jsonp可以拿回数据，我只是用来拿会歌词而已，但是现在不知道师兄师姐同不同意，还待商定。主页的index.js是用来实现主页面的功能的，这个js是最复杂的，播放器js, 使用来管理播放功能的，包括歌词，上一首，下一首，播放(暂停)，随机播放，音量等，用户详情页面根据传过来的用户id，拿回用户的数据，并且渲染出来。

- 一共用四个`css`文件，分别是`主页样式index.css`, `播放器样式music.css`, `用户详情样式userDetail.css`, `页面重置样式reset.css`。

# 各个页面的各个板块

## index.html

- 头部: 有音乐的图标，搜索框，主页mian, 用户喜欢的音乐歌单MyFavorite, 播放器页面，登录/注册和用户头像切换区域。

- 轮播图: 现在我是用网易云音乐桌面端的轮播图实现的，之前使用网页版的轮播图，后来改过来了，又学会了一种实现轮播图的方式，感觉很开心，背景是显示当前轮播到的图片，是放大加上模糊之后的背景图片。

- 最近常听: 这个板块是网络请求回来的用户常听的歌曲，但是为了防止有时请求失败，比如有时请求多了，服务器会阻止，如果请求不回来，我会放事先准备好的一个歌曲封面和歌手，歌名。

- 精彩推荐: 这个板块是介绍一些新的专辑，是使用轮播图的另一种方式实现的。

- 排行榜: 这个板块是一些新歌，热歌，流行指数，欧美，韩国的巅峰排行榜。

- 推荐音乐: 这个板块是不同地区的推荐的音乐或者这个地区的热歌。

- 歌星介绍: 这里主要是对一些歌星进行介绍

## music.html

- 主区域的左边区域: 是放当前页面的的歌名，如果是从主页跳转或直接传id的话，就会播放当前的歌，只用一首，如果什么都不传，就会去请求当前的我歌单的歌回来，

- 主区域的右边区域: 放当前播放的歌曲的图片，下面是歌词，两侧是随播放和暂停同步的旋转的正方体。

- 底部: 左侧是上一首，播放/暂停， 下一首， 中间是歌手-歌名，歌曲当前时间和总时间以及当前歌曲的进度条，右侧是可以调节顺序播放，随机播放，单曲循环模式的图标，音量的进度条.

## userDetail.html

- 上部是用户的背景图片，中间是用户的头像和关注人数，粉丝。

- 下部是用户最近播放的歌曲。


# 各个页面的各个板块的功能

## index.js

### 头部: 
`搜索框`，这个是使用网易云音乐的接口，会根据你输入的关键词去搜索，这里为了防止搜索框的频繁输入而去请求次数太多，怕网易云接口那边的服务器停了，所以我使用了函数防抖，在一秒钟内一直输入的话不会去请求，只有当输入完后的一秒才回去请求数据，返回的数据渲染在搜索框下面，点击每一条都会跳转到播放器页面播放这首歌曲，局限的是好像每次只能返回四首搜索数据。

`main`和`MyFavoriteMusic`这两个是切换的，main是当前的主页面，MyFavoriteMusic只有当登录成功后才会显示，并渲染出用户的一些歌单，我对歌单的数据的条数做了限制，没有全部显示完。

`Player`,点击后跳转到播放器页面，是不携带参数的，所以播放器页面会去请求我的歌单的音乐，拿回来。

`登录 / 注册`, 默认显示`登录/注册`, 点击后进行登录或注册，会从上往下弹出一个登录注册框，没有账号可以点击注册按钮进行注册，有账号可以使用手机号进行登录注册。我这里主要是做登录这块，这侧那块接口好像用不了，所以我只是进行手机号校验和显示注册信息的校验。在登录这块我是用了表单验证，单纯的一个页面的表单验证是比较容易的，我这里是用的这个表单插件是通用的，比较强大，只要你按照使用规则, 可以校验所用的表单，包括input, select, textarea的表单，同时可以任意配置验证规则，包括预设值，正则，函数，会一一根据你传的规则一一检验。这里的登录的手机号我用了两个校验规则， `required(必填)`和`正则匹配十一位手机号`， 密码也是使用两个校验规则，`requried(必填)`和`正则匹配6-12位手机号`。每次输入时的表单都会校验，点击登录时还会所有表单进行校验，校验成功后拿到手机号和密码进行登录注册，如果api那边返回的是密码或手机号错误时还会显示账号或密码错误，如果登录成功，`登录 / 注册`那块就会变成用户的头像，并且去请求数据回来，`MyFavoriteMusic`会显示出来，同时用户歌单的音乐条目也会返回回来，点击音乐就可以进行跳转到播放器页面去进行播放该音乐，同时下边的`最近播放`区域的音乐也会变成请求回来的用户的最近播放的歌曲， 鼠标移到用户头像时有两个功能，可以`获取个人信息`跳转到获取个人信息页面，`退出登录`, 点击后退出登录，头像MyFavoriteMusic消失，只有当登录才可以使用。在浏览器刷新时就退出登录了，我的解决方法是在登录成功后保存用户账号密码到localStore中，当刷新时从localStore拿回数据，重新登录，当退出登录时清除localStore的数据。 

- ### 轮播图

- 这里的轮播图是采用和客户端一样的轮播图，可能实现方式不同，但是效果大致相同，是使用偏移量transform的translate对每个图片进行偏移,之后通过改变类名进行改变，背景图是使用当前播放的图片作为背景，背景尺寸放大，并且模糊处理，看着效果比较好。图片是使用网易云api提供的banner接口，一共有九张图片，并且每张带有当前图片的对应歌曲的id，所以我做了处理，点击轮播图就可以跳转到音乐播放器页面进行播放该歌曲， 同时轮播图应该具有的功能大致都有了。

### 最近播放

- 这块区域默认放置我放的音乐数据，点击后可以跳转到播放器页面进行播放，当登录成功后拿回数据覆盖默认的音乐数据，拿回来的当前登录的用户的最近播放的数据，数据我限制的是30条数据，这些数据拿回来了也可以进行跳转播放。


### 精彩推荐

- 这个区域的或只是轮转默认放置的音乐专辑图片，我还没有想好怎么对这个区域请求回来的数据处理。

### 排行榜

- 有五个排行榜，点击当前排行榜的歌曲可以直接跳转播放，点展示更多的话可以动画展示当前的榜单的更多歌曲，点击也可以跳转播放。点击展示更多和点击打叉后这里的效果还是比较好看的。

### 推荐音乐

- 这里导航栏有六个选项，默认是展示内地的音乐数据，点击那块就会去请求对应的数据，并且在下面显示出来，并且这里的效果是根据鼠标的移入会有一些效果，点击播放的ico图片后就会跳转到播放器页面进行播放。


### 歌星介绍

- 这里只是显示当前歌星的信息，有鼠标移入的效果。








## music.js

### 左边栏

- 这里放置当前播放的歌曲的歌名，默认不传id的话获取请求我当前歌单的歌回来，点击歌可以切换，歌词，图片，底部的数据都会根据当前的歌曲改变

### 右边栏

- 主要数放置当前播放的歌曲的封面和歌词，不断旋转的两边侧栏正方体。图片会根据当前播放的歌曲动态展示，歌词也可以动态展示，可以根据当前播放的歌曲的某句歌词进行高亮展示，歌词当前的缺陷是在滑动播放进度条时动态改变。两边的旋转正方体是使用css3来实现的，对六个div进行平移旋转程正方体，使用animation来显示旋转，同时设置景深。

### 底部

- 这里实现了播放暂停，上一首，下一首功能，点击进度条，拖动进度条，播放时间根据歌曲播放进行改变，顺序播放，随机播放，单曲循环，音量条的改变。


## userDetail.js

- 这里主要时根据传入的用户id拿回用户的数据，对用户的背景图，头像，关注人数，粉丝进行请求数据后渲染，因为api的有些接口不能用，或者是使用时不稳定，我多次测试后选择了用户最近播放的歌曲进行展示，点击播放后也可以跳转到播放器页面播放。